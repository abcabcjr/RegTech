// Vulnerable BIND9 configuration

options {
    directory "/var/cache/bind";
    
    // Vulnerable: Allow recursion from any host
    recursion yes;
    allow-recursion { any; };
    
    // Vulnerable: Allow queries from any host
    allow-query { any; };
    
    // Vulnerable: Allow zone transfers from any host
    allow-transfer { any; };
    
    // Vulnerable: Enable version disclosure
    version "BIND 9.18.0 (Vulnerable)";
    
    // DNS forwarders
    forwarders {
        8.8.8.8;
        8.8.4.4;
    };
    
    // Vulnerable: Disable DNSSEC validation
    dnssec-validation no;
    
    auth-nxdomain no;
    listen-on-v6 { any; };
    
    // Vulnerable: Allow notify to any
    allow-notify { any; };
};

// Vulnerable zone configuration
zone "vulnerable.local" {
    type master;
    file "/etc/bind/zones/vulnerable.local.zone";
    
    // Vulnerable: Allow zone transfers from any host
    allow-transfer { any; };
    
    // Vulnerable: Allow updates from any host
    allow-update { any; };
};

zone "1.168.192.in-addr.arpa" {
    type master;
    file "/etc/bind/zones/192.168.1.rev";
    allow-transfer { any; };
};

// Root hints
zone "." {
    type hint;
    file "/usr/share/dns/root.hints";
};

// Local zones
zone "localhost" {
    type master;
    file "/etc/bind/db.local";
};

zone "127.in-addr.arpa" {
    type master;
    file "/etc/bind/db.127";
};

zone "0.in-addr.arpa" {
    type master;
    file "/etc/bind/db.0";
};

zone "255.in-addr.arpa" {
    type master;
    file "/etc/bind/db.255";
};

// Logging configuration
logging {
    channel default_debug {
        file "data/named.run";
        severity dynamic;
    };
};
